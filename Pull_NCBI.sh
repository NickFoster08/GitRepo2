#!/bin/bash
#SBATCH --job-name=Spain_WL      # Job name
#SBATCH --partition=batch                # Partition (queue) name
#SBATCH --ntasks=1                       # Run on a single CPU
#SBATCH --cpus-per-task=8                # Number of cores per task
#SBATCH --mem=80gb                       # Job memory request
#SBATCH --time=00-12:00:00               # Time limit hrs:min:sec
#SBATCH --output=/scratch/nf26742/scratch/log.%j.out  # Standard output log
#SBATCH --error=/scratch/nf26742/scratch/log.%j.err   # Standard error log

#SBATCH --mail-type=END,FAIL             # Mail events (NONE, BEGIN, END, FAIL, ALL)
#SBATCH --mail-user=nf26742@uga.edu      # Where to send mail

# Specify output directory
OUTDIR="/scratch/nf26742/Spain_WL"

# Create output directory if it doesn't exist
mkdir -p "$OUTDIR"

# Load SRA tools
module load SRA-Toolkit/3.0.3-gompi-2022a

# List of SRR accessions
accessions=(
SRR28501925
SRR28501926
SRR28501927
SRR28501929
SRR28501931
SRR28501935
SRR28501936
SRR28501937
SRR28501938
SRR28501941
SRR28501943
SRR28501944
SRR25167920
SRR25167921
SRR25167928
SRR25167929
SRR25167931
SRR25167938
SRR25167943
SRR11418329
SRR11418332
SRR21469196
SRR21469200
SRR21469201
SRR21469202
SRR15296915
SRR15296923
SRR21469197
SRR21469198
SRR21469199
SRR15296981
SRR18391642
SRR18391657
SRR18391675
SRR18391677
SRR18391695
SRR18391747
SRR18391749
SRR18391641
SRR18391646
SRR18391650
SRR18391667
SRR18391669
SRR18391670
SRR18391671
SRR18391672
SRR18391673
SRR18391720
SRR18391723
SRR18391726
SRR18391730
SRR18391736
SRR18391744
SRR18391745
SRR18391759
SRR18391760
SRR18391771
SRR18391774
SRR18391678
SRR18391696
SRR18391698
SRR18391722
SRR18391750
SRR18391758
SRR18391762
SRR18391764
SRR18391765
SRR18391766
SRR20551043
SRR20551048
SRR20551049
SRR20551030
SRR20551033
SRR20551036
SRR20551037
SRR20551038
SRR20551039
SRR20551040
SRR20551041
SRR20551042
SRR20551044
SRR20551045
SRR20551050
SRR20551051
SRR20551052
SRR20551055
SRR31924875
SRR31924880
SRR31924881
SRR31924882
SRR31924883
SRR31924888
SRR31924889
SRR31924891
ERR14783107
ERR14783108
ERR14783109
ERR14783110
ERR14783111
ERR14783112
ERR14783113
ERR14783114
ERR14783115
ERR14783116
ERR14783117
ERR14783118
ERR14783119
ERR14783120
ERR14783121
ERR14783122
ERR14783123
ERR14783124
ERR14783125
ERR14783126
ERR14783127
ERR14783128
ERR14783129
ERR14783130
ERR14783131
ERR14783132
ERR14783133
ERR14783134
ERR14783135
)

for srr in "${accessions[@]}"; do
    echo "üîÑ Downloading $srr from NCBI"

    fasterq-dump "$srr" -O "$OUTDIR" --threads 8
    if [[ $? -eq 0 ]]; then
        echo "‚úÖ Successfully downloaded and converted $srr"
    else
        echo "‚ö†Ô∏è  NCBI failed"
    fi
done
